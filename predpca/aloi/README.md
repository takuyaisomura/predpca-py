# ALOI
This directory demonstrates the application of PredPCA on the ALOI 3D rotating object image sequence.  
The code here is based on what was used to generate Figure 3 in the paper.


## Dataset download
Please download the dataset (~1.8GB) from http://aloi.science.uva.nl  
In the "Download" tab, select:
- Full color (24 bit)
- Quarter resolution (192 x 144)
- Viewing direction
and expand `aloi_red4_view.tar` in `aloi/data/` directory.  

Alternatively, you can use [our preprocessed data](https://drive.google.com/file/d/1YZSR8r61V-utfiX2JXbQ6alcaz3EttdR/view?usp=sharing) (3.65GB) by downloading it and saving it as `aloi/output/aloi_preprocessed.npz`. If you use this, you can skip the preprocessing step below.

### Reference to ALOI dataset
Geusebroek JM, Burghouts GJ, Smeulders AWM, The Amsterdam library of object images, Int J Comput Vision, 61, 103-112 (2005)


## Run
### main_preprocess.py
First, run the data preprocessing script (skip this step if using the preprocessed data):
```bash
python main_preprocess.py
```

### main.py
```bash
python main.py
```
![predpca_movie](https://github.com/user-attachments/assets/7ed4992e-6214-47a4-88e4-a92b7c2b71f2)  
PredPCA of rotated images.  
The left image in each pair shows the ground truth, while the right image shows the prediction generated by the model.  
These are 100 examples with small prediction errors selected from 200 test image sequences.

### main_plot_prediction_error.py
```bash
python main_plot_prediction_error.py
```
<img src="https://github.com/user-attachments/assets/a9cd3f6a-e17a-40d3-b83f-198450a5dd3d" height="700" alt="test_prediction_error"><br>
Comparison of test prediction error.  
PredPCA (solid lines) show a smaller test prediction error and an earlier error convergence compared with the naive autoregressive model (dashed lines).

### main_compare_models.py
```bash
python main_compare_models.py
```
Comparison of test prediction error (%) between different models. The models compared include:
- PredPCA
- AE: Standard Auto-Encoder
- VAE: Variational Auto-Encoder
- TAE: Time-lagged Auto-Encoder
- LTAE: Linear Time-lagged Auto-Encoder
- TICA: Time-lagged Independent Component Analysis

<img src="https://github.com/user-attachments/assets/73904344-4027-435c-aa16-5aa8d60681b3" width="500" alt="model comparison"><br>
The error is measured as the normalized mean squared error between predicted and actual images.
